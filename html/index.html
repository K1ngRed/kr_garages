<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>KR Garages</title>
    <link rel="stylesheet" href="style.css">
    <style>
        /* Default KR Garages small visuals (moved from script) */
        .vehicle-card.selected { border: 2px solid #3b82f6; box-shadow: 0 2px 8px rgba(0,0,0,0.15); }
        .stat-bar-fill.stat-good { background: linear-gradient(90deg,#10b981,#34d399); }
        .stat-bar-fill.stat-mid { background: linear-gradient(90deg,#f59e0b,#fbbf24); }
        .stat-bar-fill.stat-low { background: linear-gradient(90deg,#ef4444,#f97316); }
    </style>
</head>
<body>
    <div id="app" class="hidden">

        <!-- ==================== GARAGE VEHICLES MENU ==================== -->
        <div id="garageMain" class="garage-container hidden">
            <div class="garage-header">
                <div class="garage-header-left">
                    <div class="garage-icon" id="garageIcon"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M5 17h14v-5H5v5z"/><path d="M3 8l2-5h14l2 5"/><circle cx="7" cy="17" r="2"/><circle cx="17" cy="17" r="2"/><path d="M5 12h14"/></svg></div>
                    <h1 class="garage-title" id="garageName">Garaje</h1>
                </div>
                <div class="garage-header-right">
                    <span class="kr-badge">KR SCRIPT</span>
                    <button class="close-btn" onclick="closeUI()"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M18 6 6 18"/><path d="m6 6 12 12"/></svg></button>
                </div>
            </div>

            <div class="garage-search">
                <div class="search-input-wrapper">
                    <span class="search-icon"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="11" cy="11" r="8"/><path d="m21 21-4.35-4.35"/></svg></span>
                    <input type="text" class="search-input" id="searchInput" placeholder="Buscar por nombre o placa">
                </div>
            </div>

            <div class="garage-content" id="vehiclesList">
                <div class="empty-state">
                    <div class="empty-state-icon"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M5 17h14v-5H5v5z"/><path d="M3 8l2-5h14l2 5"/><circle cx="7" cy="17" r="2"/><circle cx="17" cy="17" r="2"/><path d="M5 12h14"/></svg></div>
                    <p>Cargando vehículos...</p>
                </div>
            </div>

            <div class="garage-footer">
                <div class="garage-footer-info">
                    <span class="footer-icon"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M20 10c0 6-8 12-8 12s-8-6-8-12a8 8 0 0 1 16 0Z"/><circle cx="12" cy="10" r="3"/></svg></span>
                    <span id="vehicleCount">0 vehículo(s)</span>
                </div>
                <div class="garage-footer-actions" id="garageFooterActions">
                    <!-- El botón Dar Acceso se mostrará aquí si es garaje privado y el usuario es dueño -->
                </div>
            </div>
        </div>

        <!-- ==================== PRIVATE GARAGES MENU ==================== -->
        <div id="privateGaragesMain" class="garage-container private-garages-container hidden">
            <div class="garage-header">
                <div class="garage-header-left">
                    <div class="garage-icon"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M3 9l9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z"/><polyline points="9 22 9 12 15 12 15 22"/></svg></div>
                    <h1 class="garage-title">Garajes Privados</h1>
                </div>
                <div class="garage-header-right">
                    <span class="kr-badge">KR SCRIPT</span>
                    <button class="close-btn" onclick="closeUI()"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M18 6 6 18"/><path d="m6 6 12 12"/></svg></button>
                </div>
            </div>

            <div class="garage-search">
                <div class="search-input-wrapper">
                    <span class="search-icon"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="11" cy="11" r="8"/><path d="m21 21-4.35-4.35"/></svg></span>
                    <input type="text" class="search-input" id="pgSearchInput" placeholder="Buscar por nombre">
                </div>
                <button class="btn-create" onclick="openCreateGarageModal()">
                    <span>+</span>
                    Crear Garaje Privado
                </button>
            </div>

            <div class="garage-content">
                <div class="garage-list" id="privateGaragesList">
                    <div class="empty-state">
                        <div class="empty-state-icon"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M3 9l9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z"/><polyline points="9 22 9 12 15 12 15 22"/></svg></div>
                        <p>No hay garajes privados</p>
                    </div>
                </div>
            </div>
        </div>

        <!-- ==================== TRANSFER MODAL ==================== -->
        <div id="transferModal" class="modal-overlay hidden">
            <div class="modal">
                <div class="modal-header">
                    <h2 class="modal-title">Transferir Vehículo</h2>
                    <button class="close-btn" onclick="closeTransferModal()"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M18 6 6 18"/><path d="m6 6 12 12"/></svg></button>
                </div>
                <div class="modal-body">
                    <div class="form-group">
                        <label class="form-label">Tipo de Transferencia</label>
                        <select class="form-select" id="transferType">
                            <option value="garage">A Otro Garaje</option>
                            <option value="player">A Otro Jugador</option>
                        </select>
                    </div>
                    <div class="form-group" id="targetSelectGroup">
                        <label class="form-label" id="targetLabel">Seleccionar Garaje</label>
                        <select class="form-select" id="targetSelect">
                            <option value="">Cargando...</option>
                        </select>
                    </div>
                </div>
                <div class="modal-footer">
                    <button class="btn btn-secondary" onclick="closeTransferModal()">Cancelar</button>
                    <button class="btn btn-primary" id="confirmTransferBtn">Transferir ($200)</button>
                </div>
            </div>
        </div>

        <!-- ==================== CREATE GARAGE MODAL ==================== -->
        <div id="createGarageModal" class="modal-overlay hidden">
            <div class="modal" style="width: 600px; max-height: 90vh; overflow-y: auto;">
                <div class="modal-header">
                    <h2 class="modal-title">Crear Garaje Privado</h2>
                    <button class="close-btn" onclick="closeCreateGarageModal()"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M18 6 6 18"/><path d="m6 6 12 12"/></svg></button>
                </div>
                <div class="modal-body">
                    <div class="form-row">
                        <div class="form-group">
                            <label class="form-label">Nombre del Garaje</label>
                            <input type="text" class="form-input" id="garageNameInput" placeholder="Mi Garaje">
                        </div>
                        <div class="form-group">
                            <label class="form-label">Tipo</label>
                            <select class="form-select" id="garageType">
                                <option value="car">Coche</option>
                                <option value="air">Aéreo</option>
                                <option value="boat">Barco</option>
                            </select>
                        </div>
                    </div>

                    <div class="form-group">
                        <label class="form-label">Ubicación (x, y, z, orientación)</label>
                        <div class="form-row">
                            <input type="number" class="form-input" id="locationX" placeholder="X" step="0.1">
                            <input type="number" class="form-input" id="locationY" placeholder="Y" step="0.1">
                        </div>
                        <div class="form-row" style="margin-top: 10px;">
                            <input type="number" class="form-input" id="locationZ" placeholder="Z" step="0.1">
                            <input type="number" class="form-input" id="locationHeading" placeholder="Heading" step="0.1">
                        </div>
                        <button class="btn btn-location" onclick="getCurrentLocation()" style="margin-top: 10px;">
                            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" style="width:16px;height:16px;margin-right:6px;vertical-align:middle;"><path d="M20 10c0 6-8 12-8 12s-8-6-8-12a8 8 0 0 1 16 0Z"/><circle cx="12" cy="10" r="3"/></svg>Obtener Ubicación Actual
                        </button>
                    </div>

                    <div class="form-group">
                        <label class="form-label">Radio de Interacción (metros)</label>
                        <input type="number" class="form-input" id="garageRadius" value="10" min="5" max="50">
                    </div>

                    <div class="owners-section">
                        <label class="form-label">Propietarios Adicionales</label>
                        <div class="owners-list" id="ownersList"></div>
                        <div class="owners-actions">
                            <button class="btn btn-primary" onclick="addOwner()">+ Añadir Propietario</button>
                            <button class="btn btn-secondary" onclick="clearOwners()">Limpiar Todo</button>
                        </div>
                    </div>
                </div>
                <div class="modal-footer">
                    <button class="btn btn-secondary" onclick="closeCreateGarageModal()">Cancelar</button>
                    <button class="btn btn-primary" onclick="savePrivateGarage()">Crear Garaje</button>
                </div>
            </div>
        </div>

        <!-- ==================== EDIT GARAGE MODAL ==================== -->
        <div id="editGarageModal" class="modal-overlay hidden">
            <div class="modal" style="width: 520px;">
                <div class="modal-header">
                    <h2 class="modal-title">Editar Garaje</h2>
                    <button class="close-btn" onclick="closeEditGarageModal()"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M18 6 6 18"/><path d="m6 6 12 12"/></svg></button>
                </div>
                <div class="modal-body">
                    <input type="hidden" id="editGarageId" />
                    <div class="form-group">
                        <label class="form-label">Nombre del Garaje</label>
                        <input type="text" id="editGarageName" class="form-input" />
                    </div>
                    <div class="form-row">
                        <div class="form-group">
                            <label class="form-label">Tipo</label>
                            <select id="editGarageType" class="form-select">
                                <option value="car">Coche</option>
                                <option value="air">Aéreo</option>
                                <option value="boat">Barco</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label class="form-label">Radio</label>
                            <input type="number" id="editGarageRadius" class="form-input" min="5" max="50" />
                        </div>
                    </div>
                </div>
                <div class="modal-footer">
                    <button class="btn btn-secondary" onclick="closeEditGarageModal()">Cancelar</button>
                    <button class="btn btn-primary" onclick="saveEditGarage()">Actualizar</button>
                </div>
            </div>
        </div>

        <!-- ==================== OWNER PICKER MODAL ==================== -->
        <div id="ownerModal" class="modal-overlay hidden">
            <div class="modal" style="width: 520px;">
                <div class="modal-header">
                    <h2 class="modal-title">Añadir Propietario</h2>
                    <button class="close-btn" onclick="closeOwnerModal()"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M18 6 6 18"/><path d="m6 6 12 12"/></svg></button>
                </div>
                <div class="modal-body">
                    <div class="form-group">
                        <label class="form-label">Seleccionar Jugador En Línea</label>
                        <select id="ownerSelect" class="form-select">
                            <option value="">Cargando jugadores...</option>
                        </select>
                    </div>
                </div>
                <div class="modal-footer">
                    <button class="btn btn-secondary" onclick="closeOwnerModal()">Cancelar</button>
                    <button class="btn btn-primary" onclick="confirmAddOwner()">Añadir Propietario</button>
                </div>
            </div>
        </div>

        <!-- ==================== DELETE CONFIRMATION MODAL ==================== -->
        <div id="deleteModal" class="modal-overlay hidden">
            <div class="modal" style="width: 480px;">
                <div class="modal-header">
                    <h2 class="modal-title">Eliminar Garaje</h2>
                    <button class="close-btn" onclick="closeDeleteModal()"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M18 6 6 18"/><path d="m6 6 12 12"/></svg></button>
                </div>
                <div class="modal-body">
                    <p class="delete-warning"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" style="width:18px;height:18px;margin-right:8px;vertical-align:middle;color:#f59e0b;"><path d="m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3Z"/><path d="M12 9v4"/><path d="M12 17h.01"/></svg>¿Estás seguro de que quieres eliminar este garaje permanentemente?</p>
                    <p class="delete-info">Todos los vehículos serán movidos al garaje central.</p>
                </div>
                <div class="modal-footer">
                    <button class="btn btn-secondary" onclick="closeDeleteModal()">Cancelar</button>
                    <button id="btnConfirmDelete" class="btn btn-danger" onclick="confirmDeleteGarage()">Eliminar</button>
                </div>
            </div>
        </div>

        <!-- ==================== GARAGE ACCESS SHARING MODAL ==================== -->
        <div id="accessModal" class="modal-overlay hidden">
            <div class="modal" style="width: 600px; max-height: 90vh; overflow-y: auto;">
                <div class="modal-header">
                    <h2 class="modal-title">Compartir Acceso al Garaje</h2>
                    <button class="close-btn" onclick="closeAccessModal()"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M18 6 6 18"/><path d="m6 6 12 12"/></svg></button>
                </div>
                <div class="modal-body">
                    <input type="hidden" id="accessGarageId" />
                    
                    <div class="access-info">
                        <p class="info-text">
                            <span class="info-icon"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="10"/><path d="M12 16v-4"/><path d="M12 8h.01"/></svg></span>
                            <span>Puedes compartir acceso con hasta <strong>5 usuarios</strong>. Los usuarios autorizados podrán ver el garaje, guardar y usar sus propios vehículos.</span>
                        </p>
                    </div>

                    <div class="members-section">
                        <div class="members-header">
                            <label class="form-label">Usuarios con Acceso (<span id="memberCount">0</span>/5)</label>
                        </div>
                        <div class="members-list" id="membersList">
                            <div class="empty-state-small">
                                <p>No hay usuarios con acceso compartido</p>
                            </div>
                        </div>
                    </div>

                    <div class="add-member-section">
                        <label class="form-label">Agregar Usuario</label>
                        <div class="form-group">
                            <div class="search-input-wrapper">
                                <span class="search-icon"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="11" cy="11" r="8"/><path d="m21 21-4.35-4.35"/></svg></span>
                                <input type="text" class="search-input" id="memberSearchInput" placeholder="Buscar por nombre o ID">
                            </div>
                        </div>
                        <div class="online-players-list" id="onlinePlayersList">
                            <div class="empty-state-small">
                                <p>Cargando jugadores en línea...</p>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="modal-footer">
                    <button class="btn btn-secondary" onclick="closeAccessModal()">Cerrar</button>
                </div>
            </div>
        </div>
        
        <!-- ==================== PUBLIC GARAGES ADMIN MENU ==================== -->
        <div id="publicGaragesAdmin" class="garage-container public-garages-container hidden">
            <div class="garage-header">
                <div class="garage-header-left">
                    <div class="garage-icon" style="background: linear-gradient(135deg, #06b6d4, #0891b2);"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect width="18" height="18" x="3" y="3" rx="2" ry="2"/><path d="M3 9h18"/><path d="M9 21V9"/></svg></div>
                    <h1 class="garage-title">Garajes Públicos</h1>
                    <span class="admin-badge">ADMIN</span>
                </div>
                <div class="garage-header-right">
                    <span class="kr-badge">KR SCRIPT</span>
                    <button class="close-btn" onclick="closePublicGaragesAdmin()"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M18 6 6 18"/><path d="m6 6 12 12"/></svg></button>
                </div>
            </div>

            <div class="garage-search">
                <div class="search-input-wrapper">
                    <span class="search-icon"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="11" cy="11" r="8"/><path d="m21 21-4.35-4.35"/></svg></span>
                    <input type="text" class="search-input" id="publicGarageSearchInput" placeholder="Buscar por nombre o ID">
                </div>
                <button class="btn-create" onclick="openCreatePublicGarageModal()" style="background: linear-gradient(135deg, #06b6d4, #0891b2);">
                    <span>+</span>
                    Crear Garaje Público
                </button>
            </div>

            <div class="garage-content">
                <div class="garage-list" id="publicGaragesList">
                    <div class="empty-state">
                        <div class="empty-state-icon"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect width="18" height="18" x="3" y="3" rx="2" ry="2"/><path d="M3 9h18"/><path d="M9 21V9"/></svg></div>
                        <p>No hay garajes públicos configurados</p>
                    </div>
                </div>
            </div>

            <div class="garage-footer">
                <div class="garage-footer-info">
                    <span class="footer-icon"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M12 22s-8-4.5-8-11.8A8 8 0 0 1 12 2a8 8 0 0 1 8 8.2c0 7.3-8 11.8-8 11.8z"/><circle cx="12" cy="10" r="3"/></svg></span>
                    <span id="publicGarageCount">0 garaje(s) públicos</span>
                </div>

            </div>
        </div>

        <!-- ==================== CREATE PUBLIC GARAGE MODAL ==================== -->
        <div id="createPublicGarageModal" class="modal-overlay hidden">
            <div class="modal" style="width: 650px; max-height: 90vh; overflow-y: auto;">
                <div class="modal-header" style="background: linear-gradient(135deg, #06b6d4, #0891b2);">
                    <h2 class="modal-title">Crear Garaje Público</h2>
                    <button class="close-btn" onclick="closeCreatePublicGarageModal()"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M18 6 6 18"/><path d="m6 6 12 12"/></svg></button>
                </div>
                <div class="modal-body">
                    <div class="form-row">
                        <div class="form-group" style="flex: 2;">
                            <label class="form-label">ID del Garaje (único)</label>
                            <input type="text" class="form-input" id="publicGarageId" placeholder="mi_garaje_publico">
                            <small style="color: var(--text-muted); font-size: 0.75rem;">Solo letras, números y guiones bajos</small>
                        </div>
                        <div class="form-group" style="flex: 2;">
                            <label class="form-label">Nombre</label>
                            <input type="text" class="form-input" id="publicGarageName" placeholder="Mi Garaje Público">
                        </div>
                    </div>

                    <div class="form-row">
                        <div class="form-group">
                            <label class="form-label">Tipo de Vehículos</label>
                            <select class="form-select" id="publicGarageType">
                                <option value="car">Coches</option>
                                <option value="air">Aéreos</option>
                                <option value="boat">Barcos</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label class="form-label">Radio (metros)</label>
                            <input type="number" class="form-input" id="publicGarageRadius" value="15" min="5" max="50">
                        </div>
                    </div>

                    <div class="form-section">
                        <h3 class="form-section-title"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" style="width:16px;height:16px;margin-right:6px;vertical-align:middle;"><path d="M20 10c0 6-8 12-8 12s-8-6-8-12a8 8 0 0 1 16 0Z"/><circle cx="12" cy="10" r="3"/></svg>Ubicación del Garaje</h3>
                        <div class="form-row">
                            <div class="form-group">
                                <label class="form-label">X</label>
                                <input type="number" class="form-input" id="publicGarageX" placeholder="0.0" step="0.01">
                            </div>
                            <div class="form-group">
                                <label class="form-label">Y</label>
                                <input type="number" class="form-input" id="publicGarageY" placeholder="0.0" step="0.01">
                            </div>
                            <div class="form-group">
                                <label class="form-label">Z</label>
                                <input type="number" class="form-input" id="publicGarageZ" placeholder="0.0" step="0.01">
                            </div>
                        </div>
                        <button class="btn btn-location" onclick="getPublicGarageLocation()" style="margin-top: 10px; width: 100%;">
                            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" style="width:16px;height:16px;margin-right:6px;vertical-align:middle;"><path d="M20 10c0 6-8 12-8 12s-8-6-8-12a8 8 0 0 1 16 0Z"/><circle cx="12" cy="10" r="3"/></svg>
                            Obtener Mi Ubicación Actual
                        </button>
                    </div>

                    <div class="form-section">
                        <h3 class="form-section-title"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" style="width:16px;height:16px;margin-right:6px;vertical-align:middle;"><path d="M5 17h14v-5H5v5z"/><path d="M3 8l2-5h14l2 5"/><circle cx="7" cy="17" r="2"/><circle cx="17" cy="17" r="2"/><path d="M5 12h14"/></svg>Puntos de Spawn</h3>
                        <p style="color: var(--text-muted); font-size: 0.8rem; margin-bottom: 10px;">Define dónde aparecerán los vehículos al sacarlos del garaje.</p>
                        <div id="spawnPointsList" class="spawn-points-list"></div>
                        <button class="btn btn-primary" onclick="addSpawnPoint()" style="margin-top: 10px;">
                            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" style="width:16px;height:16px;margin-right:6px;"><line x1="12" x2="12" y1="5" y2="19"/><line x1="5" x2="19" y1="12" y2="12"/></svg>
                            Agregar Punto de Spawn
                        </button>
                        <button class="btn btn-secondary" onclick="addCurrentPositionAsSpawn()" style="margin-top: 10px; margin-left: 10px;">
                            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" style="width:16px;height:16px;margin-right:6px;"><circle cx="12" cy="12" r="10"/><path d="M12 8v8"/><path d="M8 12h8"/></svg>
                            Agregar Mi Posición
                        </button>
                    </div>

                    <div class="form-section">
                        <h3 class="form-section-title"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" style="width:16px;height:16px;margin-right:6px;vertical-align:middle;"><polygon points="3 6 9 3 15 6 21 3 21 18 15 21 9 18 3 21"/><line x1="9" x2="9" y1="3" y2="18"/><line x1="15" x2="15" y1="6" y2="21"/></svg>Blip del Mapa</h3>
                        <div class="form-row">
                            <div class="form-group">
                                <label class="form-label">Sprite</label>
                                <input type="number" class="form-input" id="publicGarageBlipSprite" value="357">
                                <small style="color: var(--text-muted); font-size: 0.7rem;">357=Garaje, 410=Barco, 43=Avión</small>
                            </div>
                            <div class="form-group">
                                <label class="form-label">Color</label>
                                <input type="number" class="form-input" id="publicGarageBlipColor" value="47">
                                <small style="color: var(--text-muted); font-size: 0.7rem;">47=Verde, 1=Rojo, 3=Azul</small>
                            </div>
                            <div class="form-group">
                                <label class="form-label">Escala</label>
                                <input type="number" class="form-input" id="publicGarageBlipScale" value="0.6" step="0.1" min="0.3" max="1.5">
                            </div>
                        </div>
                    </div>
                </div>
                <div class="modal-footer">
                    <button class="btn btn-secondary" onclick="closeCreatePublicGarageModal()">Cancelar</button>
                    <button class="btn btn-primary" onclick="savePublicGarage()" style="background: linear-gradient(135deg, #06b6d4, #0891b2);">Crear Garaje</button>
                </div>
            </div>
        </div>

        <!-- ==================== GENERIC CONFIRM MODAL ==================== -->
        <div id="confirmModal" class="modal-overlay hidden">
            <div class="modal" style="width: 420px;">
                <div class="modal-header">
                    <h2 class="modal-title" id="confirmModalTitle">Confirmar</h2>
                    <button class="close-btn" onclick="closeConfirmModal()"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M18 6 6 18"/><path d="m6 6 12 12"/></svg></button>
                </div>
                <div class="modal-body">
                    <p id="confirmModalMessage" style="text-align: center; font-size: 1rem; color: var(--text-secondary);">¿Estás seguro?</p>
                </div>
                <div class="modal-footer">
                    <button class="btn btn-secondary" onclick="closeConfirmModal()">Cancelar</button>
                    <button id="confirmModalBtn" class="btn btn-danger" onclick="executeConfirmAction()">Confirmar</button>
                </div>
            </div>
        </div>

        <!-- ==================== IMPOUND FORM MODAL (POLICÍA) ==================== -->
        <div id="impoundFormModal" class="modal-overlay hidden">
            <div class="modal" style="width: 450px;">
                <div class="modal-header">
                    <div style="display: flex; align-items: center; gap: 10px;">
                        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" style="width: 24px; height: 24px; color: #ef4444;"><path d="M12 2L2 7l10 5 10-5-10-5z"/><path d="M2 17l10 5 10-5"/><path d="M2 12l10 5 10-5"/></svg>
                        <h2 class="modal-title">Confiscar Vehículo</h2>
                    </div>
                    <button class="close-btn" onclick="cancelImpoundForm()"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M18 6 6 18"/><path d="m6 6 12 12"/></svg></button>
                </div>
                <div class="modal-body">
                    <div class="form-group">
                        <label class="form-label">
                            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" style="width: 14px; height: 14px; margin-right: 6px; vertical-align: middle;"><path d="M5 17h14v-5H5v5z"/><path d="M3 8l2-5h14l2 5"/><circle cx="7" cy="17" r="2"/><circle cx="17" cy="17" r="2"/></svg>
                            Vehículo
                        </label>
                        <input type="text" class="form-input" id="impoundVehicleInfo" readonly style="background: rgba(0,0,0,0.2); cursor: not-allowed;">
                    </div>
                    <div class="form-group">
                        <label class="form-label">
                            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" style="width: 14px; height: 14px; margin-right: 6px; vertical-align: middle;"><rect x="3" y="5" width="18" height="14" rx="2"/><path d="M3 10h18"/></svg>
                            Placa
                        </label>
                        <input type="text" class="form-input" id="impoundPlate" readonly style="background: rgba(0,0,0,0.2); cursor: not-allowed;">
                    </div>
                    <div class="form-group">
                        <label class="form-label">
                            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" style="width: 14px; height: 14px; margin-right: 6px; vertical-align: middle;"><path d="M20 10c0 6-8 12-8 12s-8-6-8-12a8 8 0 0 1 16 0Z"/><circle cx="12" cy="10" r="3"/></svg>
                            Ubicación de Depósito
                        </label>
                        <select id="impoundLocation" class="form-select"></select>
                    </div>
                    <div class="form-group">
                        <label class="form-label">
                            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" style="width: 14px; height: 14px; margin-right: 6px; vertical-align: middle;"><path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"/><polyline points="14 2 14 8 20 8"/><line x1="16" y1="13" x2="8" y2="13"/><line x1="16" y1="17" x2="8" y2="17"/></svg>
                            Razón de Confiscación
                        </label>
                        <select id="impoundReason" class="form-select"></select>
                    </div>
                    <div class="form-group">
                        <label class="form-label">
                            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" style="width: 14px; height: 14px; margin-right: 6px; vertical-align: middle;"><line x1="12" y1="1" x2="12" y2="23"/><path d="M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6"/></svg>
                            Tarifa de Liberación ($)
                        </label>
                        <input type="number" class="form-input" id="impoundFee" min="100" max="10000" value="500">
                    </div>
                </div>
                <div class="modal-footer">
                    <button class="btn btn-secondary" onclick="cancelImpoundForm()">
                        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" style="width: 16px; height: 16px; margin-right: 6px;"><path d="M18 6 6 18"/><path d="m6 6 12 12"/></svg>
                        Cancelar
                    </button>
                    <button class="btn btn-danger" onclick="confirmImpoundForm()">
                        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" style="width: 16px; height: 16px; margin-right: 6px;"><path d="M12 2L2 7l10 5 10-5-10-5z"/><path d="M2 17l10 5 10-5"/><path d="M2 12l10 5 10-5"/></svg>
                        Confiscar
                    </button>
                </div>
            </div>
        </div>

        <!-- Script Badge -->
        <div class="script-badge">KG SCRIPT</div>

    </div>

    <script src="script.js"></script>
</body>
</html>
